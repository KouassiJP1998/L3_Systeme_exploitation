#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <errno.h>
#include "msq-message.h"

void msq_message_print(msq_message_t message)
{
    struct tm *info;
    time_t now ; 
    time(&now);
    info = localtime(&now);
	
	printf("%d-%02d-%02d %02d:%02d:%02d: %ld: %s \n" ,1900+info->tm_year,1+info->tm_mon,info->tm_mday,info->tm_hour,info->tm_min,info->tm_sec,message.type, message.text);
}

int msq_message_set_text(msq_message_t *message, const char *text)
{
    if (strlen(text) < MSQ_MESSAGE_TEXT_SIZE)
    {
		strcpy(message->text, text);
		return 0;	
    }
    else
    {
		fprintf (stderr ,"./msq-client.out:%s:%d: Unable to set the \"%s\" message text because its \"%d\" 	size is greater than \"%d\".\n", __FILE__, __LINE__, text, (int) strlen(text)+1, MSQ_MESSAGE_TEXT_SIZE);
		return -1;
    }
}

int msq_message_set_type(msq_message_t *message, long int type)
{
    if (type > 0)
    {
		message->type = type;
		return 0;
    }
    else
	{
		fprintf (stderr ,"./msq-client.out:%s:%d: Unable to set the \"%ld\" message type because its value is less than or equal to \"0\".\n", __FILE__, __LINE__, type);
		return -1;
	}
}
